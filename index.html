<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Diário Online</title>
  <style>
    :root { --bg:#f6f4f2; --card:#fff; --primary:#6b4eff; --secondary:#f0edff; --text:#2b2b2b; }
    * { box-sizing:border-box; font-family:'Segoe UI',system-ui,sans-serif; }
    body { margin:0; background:var(--bg); color:var(--text); padding:24px; }
    h1{text-align:center}
    .calendar{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-bottom:32px}
    .day{background:var(--card);border-radius:12px;padding:12px;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,.05);transition:all .2s}
    .day.saved{background:#e9e6ff;border:2px solid var(--primary)}
    .editor{background:var(--card);border-radius:16px;padding:24px;box-shadow:0 8px 20px rgba(0,0,0,.08)}
    .columns{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
    .column{background:var(--secondary);border-radius:12px;padding:12px;display:flex;flex-direction:column}
    textarea{border:none;border-radius:8px;padding:10px;min-height:90px}
    img{max-width:100%;border-radius:8px;margin-top:8px}
    .status{margin-top:10px;font-size:13px;color:#555}
  </style>
</head>
<body>
<script>
  const PASSWORD = 'segredosbaralho';
  if (localStorage.getItem('auth') !== 'ok') {
    const p = prompt('Digite a senha do diário');
    if (p !== PASSWORD) { document.body.innerHTML = '<h2>Acesso negado</h2>'; throw new Error(); }
    localStorage.setItem('auth','ok');
  }
</script>

<h1>Meu Diário</h1>
<div class="calendar" id="calendar"></div>

<div class="editor" id="editor" style="display:none;">
  <h2 id="selectedDay"></h2>
  <div class="columns">
    <div class="column">
      <label>Cartas</label>
      <textarea id="cartas"></textarea>
      <input type="file" id="foto" accept="image/*" />
      <img id="preview" />
    </div>
    <div class="column"><label>Percepção</label><textarea id="percepcao"></textarea></div>
    <div class="column"><label>Como foi o dia</label><textarea id="dia"></textarea></div>
  </div>
  <div class="status" id="status">Salvamento automático ativo ✨</div>
</div>

<script>
const calendar=document.getElementById('calendar');
const editor=document.getElementById('editor');
const status=document.getElementById('status');
const cartas=document.getElementById('cartas');
const percepcao=document.getElementById('percepcao');
const dia=document.getElementById('dia');
const foto=document.getElementById('foto');
const preview=document.getElementById('preview');
let key='';

function weekday(d){return d.toLocaleDateString('pt-BR',{weekday:'long'});}
function loadCalendar(){calendar.innerHTML='';const t=new Date();const y=t.getFullYear(),m=t.getMonth();const dim=new Date(y,m+1,0).getDate();const todayKey=new Date().toISOString().split('T')[0];for(let i=1;i<=dim;i++){const d=new Date(y,m,i);const k=d.toISOString().split('T')[0];const div=document.createElement('div');div.className='day';if(localStorage.getItem(k))div.classList.add('saved');if(k===todayKey)div.style.background='#dcd6ff';div.innerHTML=`<strong>${i}</strong><br><small>${weekday(d)}</small>`;div.onclick=()=>open(d);calendar.appendChild(div);}}

function open(d){key=d.toISOString().split('T')[0];editor.style.display='block';document.getElementById('selectedDay').innerText=`${weekday(d)}, ${d.toLocaleDateString('pt-BR')}`;const s=JSON.parse(localStorage.getItem(key))||{};cartas.value=s.cartas||'';percepcao.value=s.percepcao||'';dia.value=s.dia||'';preview.src=s.foto||'';}

function autosave(){if(!key)return;localStorage.setItem(key,JSON.stringify({cartas:cartas.value,percepcao:percepcao.value,dia:dia.value,foto:preview.src}));status.innerText='Salvo automaticamente ✨';setTimeout(()=>status.innerText='Salvamento automático ativo ✨',1500);loadCalendar();}

[cartas,percepcao,dia].forEach(el=>el.addEventListener('input',autosave));
foto.onchange=()=>{const r=new FileReader();r.onload=()=>{preview.src=r.result;autosave();};r.readAsDataURL(foto.files[0]);};

loadCalendar();
</script>
</body>
</html>
